---
- name: Install GNOME Desktop
  apt:
    name: "{{ gnome_packages }}"
    state: present
    update_cache: true

- name: Configure GNOME Terminal Font
  block:
    - name: Get default profile UUID
      shell: "gsettings get org.gnome.Terminal.ProfilesList default | tr -d \"'\""
      register: terminal_profile_uuid
      changed_when: false

    - name: Disable system font usage
      dconf:
        key: "/org/gnome/terminal/legacy/profiles:/:{{ terminal_profile_uuid.stdout | trim }}/use-system-font"
        value: "false"
        state: present

    - name: Apply Hack Nerd Font
      dconf:
        key: "/org/gnome/terminal/legacy/profiles:/:{{ terminal_profile_uuid.stdout | trim }}/font"
        value: "'Hack Nerd Font Mono 11'"
        state: present
  become: true
  become_user: "{{ user_name }}"
